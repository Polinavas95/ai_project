from app.schemas import StudyTopic

system_prompt = """
Ты - персональный учебный ассистент, специализирующийся на IT и программировании.

ТВОИ ОТВЕТЫ ДОЛЖНЫ БЫТЬ СТРОГО В ФОРМАТЕ JSON. НИКАКОГО ТЕКСТА ВНЕ JSON!

Пример правильного ответа:
```json
{{
    "answer": "Полный текст ответа пользователю здесь...",
    "next_topic": "Следующая рекомендуемая тема",
    "difficulty_level": "beginner"
}}
```

Правила форматирования:
- Ответ должен быть полезным, структурированным и способствовать прогрессу в выбранной теме
- Всегда возвращай валидный JSON
- Не добавляй никакого текста вне JSON
- В поле "answer" помещай основной текст ответа
- В поле "next_topic" предлагай следующую тему для изучения
- В поле "difficulty_level" указывай текущий уровень сложности

Темы, которые ты поддерживаешь:
- Python: программирование, веб-разработка, data science
- JavaScript: фронтенд, бэкенд, фреймворки  
- Algorithms: структуры данных, алгоритмы, сложность
- SQL: базы данных, запросы, оптимизация
"""

user_prompt = """
Тема обучения: {study_topic}
Уровень пользователя: {user_level}
Контекст темы: {topic_context}

История предыдущих сообщений:
{history}

Текущий вопрос пользователя: {current_message}

СФОРМИРУЙ ОТВЕТ В ФОРМАТЕ JSON:
- answer: подробный ответ на вопрос
- next_topic: следующая рекомендуемая тема 
- difficulty_level: текущий уровень сложности ({user_level})

Учти уровень пользователя и историю диалога.
"""

TOPIC_CONTEXT = {
    StudyTopic.python: {
        "description": "Программирование на Python - высокоуровневый язык с акцентом на читаемость кода",
        "key_concepts": ["синтаксис", "ООП", "фреймворки", "библиотеки", "асинхронность"],
        "learning_path": ["базовый синтаксис", "функции", "классы", "модули", "продвинутые темы"]
    },
    StudyTopic.javascript: {
        "description": "JavaScript - язык для веб-разработки, работает в браузере и на сервере",
        "key_concepts": ["DOM", "асинхронность", "фреймворки", "ES6+", "Node.js"],
        "learning_path": ["основы", "работа с DOM", "асинхронный JS", "фреймворки"]
    },
    StudyTopic.algorithms: {
        "description": "Алгоритмы и структуры данных - фундамент компьютерных наук",
        "key_concepts": ["сложность", "структуры данных", "алгоритмы поиска", "алгоритмы сортировки"],
        "learning_path": ["базовые структуры", "алгоритмы", "оптимизация", "системный дизайн"]
    },
    StudyTopic.sql: {
        "description": "SQL - язык для работы с реляционными базами данных",
        "key_concepts": ["запросы", "нормализация", "индексы", "транзакции", "оптимизация"],
        "learning_path": ["основы SQL", "сложные запросы", "оптимизация", "администрирование"]
    }
}
